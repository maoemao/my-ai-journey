# LangChainå·¥ä½œæµç¼–æ’æœ‰å“ªäº›

è¿™ä¸ªé—®é¢˜é—®å¾—éå¸¸å…³é”®ã€‚LangChain çš„â€œå·¥ä½œæµç¼–æ’ï¼ˆWorkflow Orchestrationï¼‰â€æ˜¯å®ƒçš„æ ¸å¿ƒèƒ½åŠ›ä¹‹ä¸€ï¼Œç”¨æ¥**ç»„ç»‡ã€æ§åˆ¶ã€ç»„åˆå¤šä¸ª LLM è°ƒç”¨ä¸å·¥å…·æ‰§è¡Œæ­¥éª¤**ï¼Œä»è€Œå½¢æˆä¸€ä¸ªå®Œæ•´çš„æ™ºèƒ½ä»»åŠ¡é“¾æ¡ã€‚

æˆ‘æ¥ç³»ç»Ÿåœ°ç»™ä½ è®²è®² LangChain ä¸­å¸¸ç”¨çš„ç¼–æ’æ–¹å¼ï¼Œåˆ†å±‚ä»**åŸºç¡€ â†’ é«˜çº§ â†’ å®æˆ˜åœºæ™¯**è®²ã€‚



------



## **ğŸ§© ä¸€ã€ç¼–æ’çš„æ ¸å¿ƒç›®æ ‡**

LangChain çš„ç¼–æ’æœ¬è´¨æ˜¯è®©ä½ èƒ½å¤Ÿï¼š

> **æŠŠå¤šä¸ªæ¨¡å‹è°ƒç”¨ã€å·¥å…·è°ƒç”¨ã€é€»è¾‘æ§åˆ¶ä¸²è”æˆä¸€ä¸ªå®Œæ•´æµç¨‹ã€‚**

ç®€å•ç†è§£ï¼š

> Prompt â†’ LLM â†’ åˆ¤æ–­ â†’ å·¥å…·è°ƒç”¨ â†’ å†å¤„ç† â†’ è¾“å‡ºç»“æœ



------



## **ğŸ§± äºŒã€åŸºç¡€å±‚ï¼šChainï¼ˆé“¾å¼ç»“æ„ï¼‰**

LangChain æœ€æ—©çš„æ ¸å¿ƒå°±æ˜¯â€œChainâ€ã€‚

å®ƒæ˜¯æœ€åŸºç¡€çš„ç¼–æ’å•å…ƒï¼Œé€‚ç”¨äºâ€œçº¿æ€§é¡ºåºæ‰§è¡Œâ€çš„åœºæ™¯ã€‚

### **å¸¸è§ç±»å‹ï¼š**



| **ç±»å‹**                  | **è¯´æ˜**                         | **ç¤ºä¾‹**                        |
| ------------------------- | -------------------------------- | ------------------------------- |
| **LLMChain**              | å•æ¬¡LLMè°ƒç”¨                      | æé—®â†’å›ç­”                       |
| **SequentialChain**       | å¤šä¸ªé“¾é¡ºåºæ‰§è¡Œ                   | ç¬¬ä¸€æ­¥ç”Ÿæˆæ‘˜è¦ â†’ ç¬¬äºŒæ­¥ç”Ÿæˆæ ‡é¢˜ |
| **SimpleSequentialChain** | æ›´ç®€åŒ–ç‰ˆæœ¬ï¼Œåªä¼ ä¸€ä¸ªè¾“å…¥ä¸€ä¸ªè¾“å‡º |                                 |
| **RouterChain**           | æ ¹æ®æ¡ä»¶è·¯ç”±ä¸åŒçš„å­é“¾           | ä¸åŒé—®é¢˜ç±»å‹èµ°ä¸åŒå¤„ç†é€»è¾‘      |

ğŸ‘‰ ç¤ºä¾‹ï¼š

```
from langchain.chains import LLMChain, SimpleSequentialChain
from langchain.prompts import PromptTemplate
from langchain.chat_models import ChatOpenAI

llm = ChatOpenAI(model="gpt-4")

prompt1 = PromptTemplate.from_template("æ€»ç»“è¿™æ®µæ–‡å­—: {text}")
chain1 = LLMChain(llm=llm, prompt=prompt1)

prompt2 = PromptTemplate.from_template("æ ¹æ®æ‘˜è¦ç”Ÿæˆä¸€ä¸ªæ ‡é¢˜: {summary}")
chain2 = LLMChain(llm=llm, prompt=prompt2)

workflow = SimpleSequentialChain(chains=[chain1, chain2])
result = workflow.run("LangChain æ˜¯ä¸€ä¸ªå¼ºå¤§çš„LLMå¼€å‘æ¡†æ¶â€¦â€¦")
```



------



## **âš™ï¸ ä¸‰ã€ä¸­çº§å±‚ï¼šAgentï¼ˆæ™ºèƒ½ä½“ç¼–æ’ï¼‰**

Chain è§£å†³çš„æ˜¯â€œé¡ºåºæµç¨‹â€ï¼Œä½†é‡åˆ°**åŠ¨æ€å†³ç­–**ï¼ˆæ¯”å¦‚AIéœ€è¦è‡ªå·±åˆ¤æ–­è¦ç”¨å“ªä¸ªå·¥å…·ï¼‰æ—¶ï¼Œå°±è¦ç”¨ **Agent**ã€‚

### **æ ¸å¿ƒæ€æƒ³ï¼š**

> â€œç»™AIä¸€ä¸ªå·¥å…·ç®± + è‡ªä¸»å†³ç­–èƒ½åŠ›ï¼Œè®©å®ƒæ ¹æ®ä¸Šä¸‹æ–‡é€‰æ‹©è¡ŒåŠ¨é¡ºåºã€‚â€



### **å¸¸è§ Agent ç±»å‹ï¼š**



| **ç±»å‹**                        | **ç‰¹ç‚¹**              | **åº”ç”¨åœºæ™¯**       |
| ------------------------------- | --------------------- | ------------------ |
| **ReAct Agent**                 | ç»“åˆâ€œæ¨ç† + è¡ŒåŠ¨â€æ¨¡å¼ | æ£€ç´¢ã€é—®ç­”         |
| **Tool Agent / Function Agent** | è‡ªåŠ¨è°ƒç”¨å‡½æ•°/å·¥å…·     | ç”¨äº API è°ƒç”¨      |
| **Conversational Agent**        | å…·å¤‡ä¸Šä¸‹æ–‡è®°å¿†        | å¤šè½®å¯¹è¯           |
| **Plan-and-Execute Agent**      | å…ˆè§„åˆ’ï¼Œå†æ‰§è¡Œæ­¥éª¤    | é•¿ä»»åŠ¡ã€å¤šé˜¶æ®µä»»åŠ¡ |

ğŸ‘‰ ç®€åŒ–ç¤ºä¾‹ï¼š

```
from langchain.agents import initialize_agent, load_tools
from langchain.chat_models import ChatOpenAI

llm = ChatOpenAI(model="gpt-4")
tools = load_tools(["serpapi", "llm-math"], llm=llm)

agent = initialize_agent(
    tools, llm,
    agent_type="zero-shot-react-description",
    verbose=True
)

agent.run("æŸ¥ä¸€ä¸‹2025å¹´ä¸­å›½GDPé¢„æµ‹ï¼Œå¹¶è®¡ç®—æ¯”2024å¹´å¢é•¿å¤šå°‘")
```



------



## **ğŸ” å››ã€é«˜çº§å±‚ï¼šRunnable Interfaceï¼ˆLangChain Expression Languageï¼ŒLCELï¼‰**

LangChain 1.0 åå¼•å…¥äº†ä¸€ä¸ªæ–°çš„ç¼–æ’ä½“ç³»ï¼š

**LCELï¼ˆLangChain Expression Languageï¼‰**

å®ƒæä¾›äº†ä¸€ç§å£°æ˜å¼ã€å¯ç»„åˆçš„å·¥ä½œæµè¡¨è¾¾æ–¹å¼ï¼Œæ¯”è€çš„ Chain/Agent æ›´çµæ´»ã€æ›´é«˜æ€§èƒ½ã€‚

### **ç‰¹ç‚¹ï¼š**

- æ”¯æŒåŒæ­¥ / å¼‚æ­¥æ‰§è¡Œ
- æ”¯æŒåˆ†æ”¯ã€å¹¶è¡Œã€åˆå¹¶
- å¯ç»„åˆç»„ä»¶ï¼ˆPrompt â†’ LLM â†’ Parser â†’ Outputï¼‰
- å¯¹è±¡çº§ç¼–æ’ï¼Œè€Œéå‡½æ•°çº§

ğŸ‘‰ ç¤ºä¾‹ï¼š

```
from langchain.prompts import ChatPromptTemplate
from langchain.chat_models import ChatOpenAI
from langchain.schema.output_parser import StrOutputParser

prompt = ChatPromptTemplate.from_template("è¯·ç”¨ä¸€å¥è¯æ€»ç»“ï¼š{text}")
model = ChatOpenAI(model="gpt-4")
parser = StrOutputParser()

workflow = prompt | model | parser  # LCELè¯­æ³•ï¼šåƒUnixç®¡é“ä¸€æ ·

result = workflow.invoke({"text": "LangChain æ˜¯ä¸€ä¸ªå¼ºå¤§çš„LLMç¼–æ’æ¡†æ¶..."})
```



### **LCEL æ”¯æŒçš„ç¼–æ’æ¨¡å¼ï¼š**



| **æ¨¡å¼**               | **åŠŸèƒ½**        |
| ---------------------- | --------------- |
| .map()                 | å¹¶è¡Œæ‰§è¡Œ        |
| .batch()               | æ‰¹é‡è¾“å…¥        |
| .bind()                | ç»‘å®šå›ºå®šå‚æ•°    |
| .with_fallbacks()      | å¼‚å¸¸å›é€€        |
| .with_retry()          | è‡ªåŠ¨é‡è¯•        |
| .invoke() / .astream() | åŒæ­¥ / å¼‚æ­¥è¿è¡Œ |



------



## **ğŸ§  äº”ã€æ‰©å±•å±‚ï¼šMemoryã€Callbackã€Graph ç­‰ç»„ä»¶**



| **ç»„ä»¶**                              | **ä½œç”¨**             | **è¯´æ˜**               |
| ------------------------------------- | -------------------- | ---------------------- |
| **Memory**                            | ä¿å­˜å¯¹è¯ä¸Šä¸‹æ–‡       | ç”¨äºå¤šè½®å¯¹è¯           |
| **Callback Manager**                  | ç›‘æ§æ‰§è¡Œæµç¨‹         | æ–¹ä¾¿è°ƒè¯•ã€æ—¥å¿—è¾“å‡º     |
| **LangGraph**                         | åŸºäºçŠ¶æ€æœºçš„ç¼–æ’æ¡†æ¶ | é€‚åˆå¤æ‚æµç¨‹å’Œæ¡ä»¶è·³è½¬ |
| **RunnableParallel / RunnableBranch** | å¹¶è¡Œæˆ–æ¡ä»¶æ‰§è¡Œ       | LCELçš„é«˜çº§åº”ç”¨         |

ğŸ‘‰ LangGraph æ˜¯æ–°ä¸€ä»£é‡ç‚¹æ–¹å‘ï¼š

å¯ä»¥ç”¨ç±»ä¼¼â€œçŠ¶æ€å›¾â€çš„æ–¹å¼è¡¨è¾¾å¤æ‚Agenté€»è¾‘ã€‚

```
from langgraph.graph import StateGraph

graph = StateGraph()
# æ·»åŠ èŠ‚ç‚¹ã€è¾¹ï¼Œå®šä¹‰çŠ¶æ€è½¬æ¢
```

------



## **ğŸ§© å…­ã€æ€»ç»“å¯¹æ¯”**



| **ç¼–æ’æ–¹å¼**        | **ç‰¹ç‚¹**       | **é€‚ç”¨åœºæ™¯**                |
| ------------------- | -------------- | --------------------------- |
| **Chain**           | ç®€å•ã€é¡ºåºæ‰§è¡Œ | å•çº¿ä»»åŠ¡æµç¨‹                |
| **SequentialChain** | å¤šæ­¥éª¤ä»»åŠ¡     | å†…å®¹ç”Ÿæˆã€æ•°æ®å¤„ç†          |
| **Agent**           | åŠ¨æ€å†³ç­–       | å·¥å…·è°ƒç”¨ã€æ™ºèƒ½é—®ç­”          |
| **LCEL**            | å£°æ˜å¼ã€å¯ç»„åˆ | é«˜æ€§èƒ½ç¼–æ’ã€æœåŠ¡ç«¯éƒ¨ç½²      |
| **LangGraph**       | å›¾å¼çŠ¶æ€æ§åˆ¶   | å¤æ‚ä»»åŠ¡æµï¼ˆå¦‚å¤šAgentåä½œï¼‰ |

------



## **ğŸš€ ä¸ƒã€å®æˆ˜å»ºè®®**

å¦‚æœä½ è¦åœ¨ **Dify / LangChain / Ollama** ä¸Šå¼€å‘è‡ªå·±çš„æ™ºèƒ½å·¥ä½œæµï¼Œå»ºè®®è·¯çº¿æ˜¯ï¼š

1. **æŒæ¡ LCEL** â†’ ç°ä»£ LangChain çš„æ ¸å¿ƒè¯­æ³•
2. **äº†è§£ Agent æ¨¡å‹** â†’ å·¥å…·è°ƒç”¨å’ŒçŸ¥è¯†æ£€ç´¢çš„åŸºç¡€
3. **ç†Ÿæ‚‰ LangGraph** â†’ æœªæ¥æ„å»ºå¤æ‚å¤šAgentç³»ç»Ÿçš„è¶‹åŠ¿

------

